<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <title>Browse - Scale Up</title>
  <!-- Custom navigation bar CSS -->
  <link rel="stylesheet" href="navigationtop.css">
  <style>
    body {
      margin: 0;
      background: #f5f6fa;
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, Arial, sans-serif;
      color: #111;
    }
    h1 {
      font-size: 2.4rem;
      font-weight: 800;
      color: #111;
      margin: 36px 0 32px 0;
      text-align: center;
      letter-spacing: 0.01em;
    }
    .category-section {
      margin-bottom: 54px;
    }
    .category-title {
      font-size: 2rem;
      font-weight: 800;
      color: #111;
      margin: 18px 0 10px 3vw;
      text-align: left;
      letter-spacing: 0.01em;
      line-height: 1.2;
    }
    .category-carousel {
      overflow-x: auto;
      display: flex;
      flex-direction: row;
      gap: 28px;
      padding: 20px 22px 8px 22px;
      border-radius: 16px;
      border: 1.5px solid #d1d5db;
      background: #fff;
      box-shadow: 0 4px 18px 0 rgba(60,60,60,0.06);
      margin: 0 2vw;
    }
    .product-card {
      background: #fff;
      border-radius: 10px;
      box-shadow: 0 1px 6px rgba(30,32,42,0.07);
      min-width: 210px;
      max-width: 250px;
      flex: 0 0 210px;
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      min-height: 160px;
      scroll-snap-align: start;
      border: 1px solid #e5e7eb;
      padding: 16px 18px;
    }
    .product-card img {
      width: 74px;
      height: 74px;
      object-fit: cover;
      border-radius: 7px;
      margin-bottom: 13px;
      background: #f5f6fa;
      border: 1px solid #e5e7eb;
      display: block;
    }
    .product-title {
      font-size: 1.09rem;
      font-weight: 700;
      margin-bottom: 5px;
      color: #222;
      text-align: left;
      width: 100%;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .product-desc {
      font-size: 0.98rem;
      color: #444;
      text-align: left;
      width: 100%;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }
    @media (max-width: 700px) {
      h1 { font-size: 1.45rem; }
      .category-title { font-size: 1.13rem; }
      .category-carousel { gap: 12px; padding: 10px 4vw 6px 4vw; }
      .product-card { min-width: 130px; max-width: 88vw; padding: 9px 4vw; }
    }
  </style>
</head>
<body>
<!-- Navigation Bar Example (customize as needed) -->
<nav class="nav-top">
  <a href="index.html" class="nav-logo">Scale Up</a>
  <div class="nav-links">
    <a href="browse.html" class="nav-link active">Browse</a>
    <a href="about.html" class="nav-link">About</a>
    <a href="contact.html" class="nav-link">Contact</a>
  </div>
  <!-- Search Bar moved into nav-top -->
  <form class="search-bar" id="browseSearchForm" autocomplete="off" onsubmit="return false;">
    <input type="text" id="searchInput" placeholder="Search businesses, products, or keywords..." />
    <button class="search-icon-btn" id="searchBtn" aria-label="Search">
      <svg width="22" height="22" viewBox="0 0 22 22" fill="none">
        <circle cx="10" cy="10" r="7" stroke="#222" stroke-width="2"/>
        <line x1="15.293" y1="15.707" x2="20" y2="20" stroke="#222" stroke-width="2" stroke-linecap="round"/>
      </svg>
    </button>
  </form>
  <div class="nav-user">
    <img src="https://via.placeholder.com/34" class="nav-avatar" alt="User" />
    <button class="nav-btn">Sign In</button>
  </div>
</nav>

<h1>Browse Categories</h1>
<div id="all-categories"></div>

<!-- Firebase SDKs (version 8 - Realtime Database) -->
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
<script>
const firebaseConfig = {
  apiKey: "AIzaSyDZsj-cL_T_BuLtAz5bkqsw-edZXnumwe0",
  authDomain: "iot-web-58054.firebaseapp.com",
  databaseURL: "https://iot-web-58054-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "iot-web-58054",
  storageBucket: "iot-web-58054.appspot.com",
  messagingSenderId: "949884902967",
  appId: "1:949884902967:web:6e7f78c7cd0fa1484629b2",
  measurementId: "G-5C79490N66"
};
if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);
const db = firebase.database();



async function getAllProductsFromProductsNode() {
  const snap = await db.ref("products").once("value");
  const allProducts = [];
  const obj = snap.val() || {};
  Object.entries(obj).forEach(([accountNum, prodGroup]) => {
    Object.entries(prodGroup || {}).forEach(([prodId, prod]) => {
      allProducts.push({
        ...prod,
        prodId,
        accountNum
      });
    });
  });
  return allProducts;
}

// 2. Render products into a nice grid/list
function renderAllProductsList(products) {
  const container = document.getElementById('all-categories');
  container.innerHTML = '';
  if (!products.length) {
    container.innerHTML = `<div style="text-align:center;color:#aaa;font-style:italic;margin:50px 0;">No products found.</div>`;
    return;
  }
  let html = `<div style="display:flex;flex-wrap:wrap;gap:32px;justify-content:center;">`;
  products.forEach(prod => {
    html += `
      <div class="product-card" style="max-width:240px;">
        <img src="${prod.imageUrl || 'https://via.placeholder.com/80'}" alt="${prod.productName || ''}">
        <div class="product-title">${prod.productName || ''}</div>
        <div class="product-desc">${prod.productDesc || ''}</div>
        <div style="color:#555;font-size:0.95em;margin:3px 0 0 0;">
          <b>Owner:</b> ${prod.userName || prod.userId || ''}
        </div>
        <div style="color:#888;font-size:0.92em;">Category: ${prod.productCategory || ''} â€¢ ${prod.productSubcategory || ''}</div>
      </div>
    `;
  });
  html += `</div>`;
  container.innerHTML = html;
}

// 3. Load and display all products on page load
async function loadAllProductsFromProductsNode() {
  const allProducts = await getAllProductsFromProductsNode();
  renderAllProductsList(allProducts);
}

window.onload = function() {
  loadAllProductsFromProductsNode();
};
</script>
</body>
</html>